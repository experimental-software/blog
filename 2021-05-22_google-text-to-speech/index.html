<!doctype html><html><head><meta charset=utf-8><title>Google Text to Speech</title><link href=/blog/post.css rel=stylesheet type=text/css><link href=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/css/bootstrap.min.css rel=stylesheet integrity=sha384-giJF6kkoqNQ00vy+HMDP7azOuL0xtbfIcaT9wjKHr8RbDVddVHyTfAAsrekwKmP1 crossorigin=anonymous><script src=https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta1/dist/js/bootstrap.bundle.min.js integrity=sha384-ygbV9kiqUc6oa4msXn9868pTtWMgiQaeYH7/t7LECLbyPA2x65Kgf80OJFdroafW crossorigin=anonymous></script><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css integrity="sha512-+4zCK9k+qNFUR5X+cKL9EIR+ZOhtIloNl9GIKS57V1MyNsYpYcUrUeQc9vNfzsWfV28IaLL3i96P9sdNyeRssA==" crossorigin=anonymous></head><body><div id=title style=background:#fff;opacity:1><a href=/blog/><i class="fas fa-times"></i></a><span>Google Text to Speech</span></div><div class=row style=margin:0><div class=col><div id=content><p>This blog post shows how to generate MP3 files from text with the Google Cloud speech synthesizer and the Unix command-line interface.</p><h2 id=setup>Setup</h2><p>To setup the Google Cloud account with the Text-to-Speech functionality, follow <a href="https://cloud.google.com/text-to-speech/docs/quickstart-protocol?hl=en">their setup instructions</a>.</p><p>Then you need to export an environment variable with the key file as value.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>export GOOGLE_APPLICATION_CREDENTIALS<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>/mykey.json
</code></pre></div><h2 id=request-payload>Request payload</h2><p>The speech generation request requires the following request payload:</p><p><em>request.json</em>:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;input&#34;</span>:{
    <span style=color:#f92672>&#34;text&#34;</span>:<span style=color:#e6db74>&#34;This is just a test&#34;</span>
  },
  <span style=color:#f92672>&#34;voice&#34;</span>:{
    <span style=color:#f92672>&#34;languageCode&#34;</span>:<span style=color:#e6db74>&#34;en-gb&#34;</span>,
    <span style=color:#f92672>&#34;name&#34;</span>:<span style=color:#e6db74>&#34;en-GB-Standard-A&#34;</span>,
    <span style=color:#f92672>&#34;ssmlGender&#34;</span>:<span style=color:#e6db74>&#34;FEMALE&#34;</span>
  },
  <span style=color:#f92672>&#34;audioConfig&#34;</span>:{
    <span style=color:#f92672>&#34;audioEncoding&#34;</span>:<span style=color:#e6db74>&#34;MP3&#34;</span>
  }
}
</code></pre></div><h2 id=generate-audio-file>Generate audio file</h2><p>The audio file can be generated with cURL like this:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>curl -X POST <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;Authorization: Bearer &#34;</span><span style=color:#66d9ef>$(</span>gcloud auth application-default print-access-token<span style=color:#66d9ef>)</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -H <span style=color:#e6db74>&#34;Content-Type: application/json; charset=utf-8&#34;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  -d @request.json <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>  https://texttospeech.googleapis.com/v1/text:synthesize
</code></pre></div><h2 id=convert-to-mp3>Convert to MP3</h2><p>The response for the generation request is a JSON payload which contains an <code>audioContent</code> property with the MP3 being a base 64 encoded binary.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash>cat response.json | jq -r <span style=color:#e6db74>&#39;.audioContent&#39;</span> | base64 -d &gt; result.mp3
</code></pre></div><h2 id=references>References</h2><ul><li><a href="https://cloud.google.com/text-to-speech/docs/quickstart-protocol?hl=en">https://cloud.google.com/text-to-speech/docs/quickstart-protocol?hl=en</a></li><li><a href="https://cloud.google.com/text-to-speech/docs/list-voices?hl=en">Listing all supported voices</a></li><li><a href=https://issuetracker.google.com/issues/188855923>Feature request for support of Punjabi</a></li></ul></div></div></div><div id=contact><a href=/blog/imprint>Imprint</a></div></body></html>